function r(e,n){return new Promise((c,i)=>{let o=document.createElement("CANVAS");const t=o.getContext("2d"),a=new Image;a.crossOrigin="",a.onload=function(){if(!o||!t)return i();o.height=a.height,o.width=a.width,t.drawImage(a,0,0);const d=o.toDataURL(n||"image/png");o=null,c(d)},a.src=e})}function s(e){const n=e.split(","),i=n[0].match(/:(.*?);/)[1],o=window.atob(n[1]);let t=o.length;const a=new Uint8Array(t);for(;t--;)a[t]=o.charCodeAt(t);return new Blob([a],{type:i})}function l(e,n,c){const i=new Blob([e],{type:c||"application/octet-stream"}),o=window.URL.createObjectURL(i),t=document.createElement("a");t.style.display="none",t.href=o,t.setAttribute("download",n),typeof t.download>"u"&&t.setAttribute("target","_blank"),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(o)}function w(e,n,c){const i=s(e);l(i,n,c)}function f(e,n,c){n||(n=e.slice(e.lastIndexOf("/")+1)),r(e).then(i=>{w(i,n,c)})}function u(e,n="_self",c){const i=window.navigator.userAgent.toLowerCase().indexOf("chrome")>-1,o=window.navigator.userAgent.toLowerCase().indexOf("safari")>-1;if(/(iP)/g.test(window.navigator.userAgent))return console.error("您的浏览器不支持下载!"),!1;if(i||o){const t=document.createElement("a");if(t.href=e,t.target=n,t.download!==void 0&&(t.download=c||e.substring(e.lastIndexOf("/")+1,e.length)),document.createEvent){const a=document.createEvent("MouseEvents");return a.initEvent("click",!0,!0),t.dispatchEvent(a),!0}}return e.indexOf("?")===-1&&(e+="?download"),window.open(e,n),!0}export{w as a,u as b,l as c,f as d};
